<section id="profile" class="p-10 pt-20 text-center fade-in transition-opacity duration-500">
    <button id="dark-mode-toggle" class="absolute top-4 right-4 bg-gray-700 text-white px-3 py-1 rounded-lg">ðŸŒ™</button>
    
    <h2 class="text-3xl font-bold">User Profile</h2>
    <p class="text-gray-400 mt-2">View and update your profile information</p>

    <div class="mt-6 bg-gray-800 p-6 rounded-lg shadow-lg max-w-lg mx-auto text-center">
        <input type="file" id="profile-pic-input" accept="image/*" class="hidden">
        <label for="profile-pic-input" class="cursor-pointer inline-block">
            <img id="profile-pic" src="https://media.licdn.com/dms/image/v2/D4D03AQHGUg0NhF_xVg/profile-displayphoto-shrink_800_800/B4DZPN4S1OHcAc-/0/1734325908946?e=1745452800&v=beta&t=UE9L_-dF_L3dHc5PmRHrMi3WW9xDpTxjOEMugDsByKM" alt="Profile Picture" class="rounded-full w-32 mx-auto border-4 border-gray-700 hover:scale-105 transition-transform duration-300">
        </label>

        <h3 id="profile-name" class="text-xl font-bold mt-4 text-white">Arghya Roy</h3>
        <p id="profile-username" class="text-gray-400">@Bubun-M</p>
        <p class="mt-2 text-gray-300">Participation: <span id="profile-participation" class="font-semibold text-blue-400">5</span> Events | Wins: <span id="profile-wins" class="font-semibold text-green-400">2</span></p>
        
        <button id="edit-profile-btn" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg w-full transition duration-300">Edit Profile</button>
    </div>
    
    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center transition-opacity duration-300">
        <div class="bg-gray-800 p-6 rounded-lg shadow-lg w-11/12 sm:w-1/2 md:w-1/3 transform scale-95 opacity-0 transition-transform transition-opacity duration-300">
            <h3 class="text-xl font-bold text-center text-white">Edit Profile</h3>
            <input type="text" id="edit-name" placeholder="Full Name" class="w-full p-2 mb-2 rounded-lg text-black">
            <input type="text" id="edit-username" placeholder="Username" class="w-full p-2 mb-2 rounded-lg text-black">
            <input type="email" id="edit-email" placeholder="Email" class="w-full p-2 mb-2 rounded-lg text-black">
            <input type="number" id="edit-participation" placeholder="Participation Count" class="w-full p-2 mb-2 rounded-lg text-black">
            <input type="number" id="edit-wins" placeholder="Wins" class="w-full p-2 mb-2 rounded-lg text-black">
            <p id="error-msg" class="text-red-500 text-center hidden">Please fill all fields correctly!</p>
            <p id="success-msg" class="text-green-500 text-center hidden">Profile updated successfully!</p>
            <button id="save-profile-btn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded w-full">Save Changes</button>
            <button id="close-modal" class="mt-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded w-full">Cancel</button>
        </div>
    </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const darkModeToggle = document.getElementById("dark-mode-toggle");
    const body = document.body;
    const modal = document.getElementById("edit-profile-modal");
    const editBtn = document.getElementById("edit-profile-btn");
    const closeModal = document.getElementById("close-modal");
    const saveBtn = document.getElementById("save-profile-btn");
    const errorMsg = document.getElementById("error-msg");
    const successMsg = document.getElementById("success-msg");
    const profilePicInput = document.getElementById("profile-pic-input");
    const profilePic = document.getElementById("profile-pic");

    // Dark Mode Toggle
    if (localStorage.getItem("darkMode") === "enabled") {
        body.classList.add("dark");
    }
    darkModeToggle.addEventListener("click", () => {
        body.classList.toggle("dark");
        localStorage.setItem("darkMode", body.classList.contains("dark") ? "enabled" : "disabled");
    });

    // Open Edit Profile Modal
    editBtn.addEventListener("click", () => {
        modal.classList.remove("hidden");
        setTimeout(() => modal.classList.add("opacity-100"), 10);
    });
    closeModal.addEventListener("click", () => {
        modal.classList.add("opacity-0");
        setTimeout(() => modal.classList.add("hidden"), 300);
    });

    // Save Profile Changes with Validation
    saveBtn.addEventListener("click", () => {
        const name = document.getElementById("edit-name").value.trim();
        const email = document.getElementById("edit-email").value.trim();
        if (!name || !email.includes("@")) {
            errorMsg.classList.remove("hidden");
            successMsg.classList.add("hidden");
            return;
        }
        errorMsg.classList.add("hidden");
        successMsg.classList.remove("hidden");
        setTimeout(() => successMsg.classList.add("hidden"), 2000);
        closeModal.click();
    });

    // Profile Picture Upload Preview
    profilePicInput.addEventListener("change", function () {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                profilePic.src = e.target.result;
                localStorage.setItem("profilePic", e.target.result);
            };
            reader.readAsDataURL(file);
        }
    });

    // Load stored dark mode and profile pic
    if (localStorage.getItem("profilePic")) {
        profilePic.src = localStorage.getItem("profilePic");
    }
});
</script>
